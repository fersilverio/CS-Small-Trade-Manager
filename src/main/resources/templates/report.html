<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{layout/model}">

<head>
    <title>Small Trade Manager - Consultar Relatório</title>
</head>
<body>
<div class="container" layout:fragment="conteudo">
    <div class="my-3 text-center">
        <img alt="Produto" class="img-fluid mx-3" height="50" src="img/report.svg" width="50"/>
        <h2>Relatórios</h2>
    </div>

    <form accept-charset="utf-8" action="/search_report" autocomplete="on" enctype="application/x-www-form-urlencoded" id="search_report" method="get" name="search_report" rel="noopener" target="_self">
        <div class="form-row justify-content-center">
            <div class="col-md-4 form-group">
                <input class="form-control" form="search_report" id="search" name="search" placeholder="Procurar relatório" type="search"/>
            </div>
            <div class="col-md-1 form-group">
                <input class="btn btn-dark" form="search_report" type="submit" value="Procurar">
            </div>
            <div class="col-md-1 form-group">
                <a class="btn btn-primary" th:href="@{/report}">Atualizar</a>
            </div>
        </div>
    </form>
</div>

<th:block layout:fragment="report-extra">
    <script type="text/javascript">
        function chartPurchases() {
            var chart = new CanvasJS.Chart("chart-purchases", {
                animationEnabled: true,
                backgroundColor: "#F8F9FA",
                zoomEnabled: true,
                theme: "light2",
                title:{
                    text: "Compras de 2020"
                },
                data: data
            });
            chart.render();
        }
        var limit = 20000;
        var y = 0;
        var data = [];
        var dataSeries = { type: "line" };
        var dataPoints = [];
        for (var i = 0; i < limit; i += 1) {
            y += (Math.random() * 10 - 5);
            dataPoints.push({
                x: 1+i/1750,
                y: Math.abs(y*100)
            });
        }
        dataSeries.dataPoints = dataPoints;
        data.push(dataSeries);
    </script>

    <script type="text/javascript">
        function chartBudgets() {
            var dps = [];
            var chart = new CanvasJS.Chart("chart-budgets", {
                backgroundColor: "#F8F9FA",
                exportEnabled: true,
                theme: "light2",
                title :{
                    text: "Orçamentos de 2020"
                },
                data: [{
                    type: "spline",
                    markerSize: 0,
                    dataPoints: dps
                }]
            });
            var xVal = 0;
            var yVal = 5000;
            var updateInterval = 1000;
            var dataLength = 50;
            var updateChart = function (count) {
                count = count || 1;
                for (var j = 0; j < count; j++) {
                    yVal = yVal + Math.round(5 + Math.random() *(-5-5));
                    dps.push({
                        x: xVal,
                        y: yVal
                    });
                    xVal++;
                }
                if (dps.length > dataLength) {
                    dps.shift();
                }
                chart.render();
            };
            updateChart(dataLength);
            setInterval(function(){ updateChart() }, updateInterval);
        }
    </script>

    <script type="text/javascript">
        function chartServices () {
            var chart = new CanvasJS.Chart("chart-services", {
                animationEnabled: true,
                backgroundColor: "#F8F9FA",
                theme: "light2",
                title:{
                    text: "Serviços de 2020"
                },
                axisX:{
                    valueFormatString: "DD MMM"
                },
                axisY: {
                    scaleBreaks: {
                        autoCalculate: true
                    }
                },
                data: [{
                    type: "line",
                    xValueFormatString: "DD MMM",
                    color: "#F08080",
                    dataPoints: [
                        { x: new Date(2020, 0, 1), y: 610 },
                        { x: new Date(2020, 0, 15), y: 680 },
                        { x: new Date(2020, 0, 30), y: 690 },
                        { x: new Date(2020, 1, 1), y: 700 },
                        { x: new Date(2020, 1, 15), y: 710 },
                        { x: new Date(2020, 1, 28), y: 658 },
                        { x: new Date(2020, 2, 1), y: 734 },
                        { x: new Date(2020, 2, 15), y: 963 },
                        { x: new Date(2020, 2, 30), y: 847 },
                        { x: new Date(2020, 3, 1), y: 853 },
                        { x: new Date(2020, 3, 15), y: 869 },
                        { x: new Date(2020, 3, 30), y: 943 },
                        { x: new Date(2020, 4, 1), y: 970 },
                        { x: new Date(2020, 4, 15), y: 869 },
                        { x: new Date(2020, 4, 30), y: 890 },
                        { x: new Date(2020, 5, 1), y: 930 },
                        { x: new Date(2020, 5, 15), y: 1850 },
                        { x: new Date(2020, 5, 30), y: 1905 },
                        { x: new Date(2020, 6, 1), y: 1980 },
                        { x: new Date(2020, 6, 15), y: 1858 },
                        { x: new Date(2020, 6, 30), y: 1034 },
                        { x: new Date(2020, 7, 1), y: 963 },
                        { x: new Date(2020, 7, 15), y: 847 },
                        { x: new Date(2020, 7, 30), y: 853 },
                        { x: new Date(2020, 8, 1), y: 869 },
                        { x: new Date(2020, 8, 15), y: 943 },
                        { x: new Date(2020, 8, 30), y: 970 },
                        { x: new Date(2020, 9, 1), y: 869 },
                        { x: new Date(2020, 9, 15), y: 890 },
                        { x: new Date(2020, 9, 30), y: 930 },
                        { x: new Date(2020, 10, 1), y: 750 },
                        { x: new Date(2020, 10, 15), y: 1070 },
                        { x: new Date(2020, 10, 30), y: 876 },
                        { x: new Date(2020, 11, 1), y: 985 },
                        { x: new Date(2020, 11, 15), y: 987 },
                        { x: new Date(2020, 11, 30), y: 1500 }
                    ]
                }]
            });
            chart.render();
        }
    </script>

    <script type="text/javascript">
        function chartSales() {
            var chart = new CanvasJS.Chart("chart-sales", {
                animationEnabled: true,
                backgroundColor: "#F8F9FA",
                theme: "light2",
                title:{
                    text: "Vendas de 2020"
                },
                data: [{
                    type: "line",
                    indexLabelFontSize: 16,
                    color: "#219C35",
                    dataPoints: [
                        { x: 1, y: 45000 },
                        { x: 2, y: 41400},
                        { x: 3, y: 52000, indexLabel: "\u2191 Maior", markerColor: "red", markerType: "triangle" },
                        { x: 4, y: 46000 },
                        { x: 5, y: 45000 },
                        { x: 6, y: 50000 },
                        { x: 7, y: 48000 },
                        { x: 8, y: 48000 },
                        { x: 9, y: 41000, indexLabel: "\u2193 Menor", markerColor: "DarkSlateGrey", markerType: "cross" },
                        { x: 10, y: 50000 },
                        { x: 11, y: 48000 },
                        { x: 12, y: 51000 }
                    ]
                }]
            });
            chart.render();
        }
    </script>

    <script type="text/javascript">
        window.onload = function() {
            chartPurchases();
            chartBudgets();
            chartServices();
            chartSales();
        }
    </script>
</th:block>

<div class="container-fluid" layout:fragment="conteudo-tabela">
    <div id="chart-purchases" style="height: 370px; width: 100%;"></div>
    <br/><br/>
    <div id="chart-budgets" style="height: 370px; width: 100%;"></div>
    <br/><br/>
    <div id="chart-services" style="height: 370px; width: 100%;"></div>
    <br/><br/>
    <div id="chart-sales" style="height: 370px; width: 100%;"></div>
</div>
<th:block layout:fragment="javascript-extra">
    <script th:src="@{/js/canvasjs.min.js}"></script>
</th:block>
</body>
</html>